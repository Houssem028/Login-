<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ASH Window Cleaning</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f5f7fa; color:#333; }
h2 { text-align:center; }
.rating-box { max-width:400px; margin:30px auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); text-align:center; }
.stars span { font-size:30px; cursor:pointer; margin:0 3px; }
input { width:100%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc; }
button { background:#0a5cff; color:white; padding:12px; border:none; border-radius:8px; cursor:pointer; width:100%; }
button:hover { background:#084dcc; }
#msg { margin-top:10px; font-weight:bold; color:green; }
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>

<h2>قيّم خدمتنا</h2>

<div class="rating-box">
  <div class="stars" id="star-container">
    <span data-value="1">⭐</span>
    <span data-value="2">⭐</span>
    <span data-value="3">⭐</span>
    <span data-value="4">⭐</span>
    <span data-value="5">⭐</span>
  </div>
  <div id="name-email-container" style="display:none; margin-top:15px;">
    <input type="text" id="user-name" placeholder="اسمك">
    <input type="email" id="user-email" placeholder="البريد الإلكتروني">
    <button id="submit-rating">إرسال التقييم</button>
  </div>
  <div id="msg"></div>
</div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAJxzFknapSh0fnPfIXwEEK3OijSKlqxco",
  authDomain: "admin-ash-f622c.firebaseapp.com",
  projectId: "admin-ash-f622c",
  databaseURL: "https://admin-ash-f622c-default-rtdb.firebaseio.com/",
  storageBucket: "admin-ash-f622c.appspot.com",
  messagingSenderId: "76505742154",
  appId: "1:76505742154:web:dc4f190f9f2de80acb1fb3"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ===== التقييم التفاعلي =====
let selectedRating = 0;
const stars = document.querySelectorAll("#star-container span");
const nameEmailContainer = document.getElementById("name-email-container");

stars.forEach(star => {
  star.addEventListener("click", () => {
    selectedRating = star.getAttribute("data-value");
    stars.forEach(s => s.style.color = "#ccc");
    for(let i=0; i<selectedRating; i++) stars[i].style.color = "#FFD700";
    nameEmailContainer.style.display = "block";
  });
});

// إرسال التقييم
document.getElementById("submit-rating").addEventListener("click", () => {
  const name = document.getElementById("user-name").value.trim();
  const email = document.getElementById("user-email").value.trim();
  if(selectedRating === 0 || !name || !email){
    alert("يرجى اختيار التقييم وكتابة الاسم والإيميل");
    return;
  }

  const ratingData = {
    name,
    email,
    rating: selectedRating,
    timestamp: Date.now()
  };

  db.ref("ratings").push(ratingData).then(() => {
    document.getElementById("msg").textContent = "تم إرسال التقييم بنجاح ✅";
    // إعادة ضبط الحقول
    selectedRating = 0;
    stars.forEach(s => s.style.color = "#000");
    document.getElementById("user-name").value = "";
    document.getElementById("user-email").value = "";
    nameEmailContainer.style.display = "none";
  }).catch(err => {
    alert("حدث خطأ أثناء الإرسال: " + err);
  });
});
</script>

</body>
</html>
